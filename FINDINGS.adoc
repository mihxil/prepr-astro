= Findings


== Editor

https://news-vpro-mihxil.prepr.io/

- Bootstrapped with sample data/model


== API
Just put the key in `.env`

This repo is a for of a astro-demo from prepr. Will just play a bit with it.

== Astro example

- install yarn and pnpm using brew, then follow the steps in `README.md`

== Flask example

Also tries a flask frontend, since I'm a bit more familiar with that.

use the virtualenvironment described in #Data-migratie.

[source, bash]]
----
cd flask 
flask$ flask --debug run
 * Debug mode: on
2023-06-20 21:14:41,473 INFO WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on http://127.0.0.1:5000
2023-06-20 21:14:41,473 INFO Press CTRL+C to quit
2023-06-20 21:14:41,474 INFO  * Restarting with stat
2023-06-20 21:14:41,597 WARNING  * Debugger is active!
2023-06-20 21:14:41,603 INFO  * Debugger PIN: 711-940-217

== Model

No idea of the model allowe for enough features. E.g. I tried to add a UUID field, to store the original UUID in magnolia. I think I could only try to validate it with regex pattern?

In this case it would perhaps make sense to just reused the id, UUID are unique, aren't they? I haven't figured out how to do that yet.
- Simple posting to content_images/<my uuid> gives 404.  -> Isn't possible right now (though Tim suggest that it might be possible to improve that)


== Issues & Remarks

- Het was mogelijk om een artikel te maken zonder content, artikel pagina gaf foutmelding. Validatie-issue/frontend-issue?

- De titel zag er eerst raar uit:
+
image:findings/raar-karakter.png[]
Kon domweg gefixt worden in de redactieomgeving, want daar had ik blijkbaar een onzichbare whitespace gemaakt. Maar raar dat dat zo makkelijk gebeurt.
- Ik weet niet wat ik er van vind dat alles is geprefixt met locales.
- Debuggen kan ook via de gui bij de access token. Daar kun je zien wat je recent fout deed.
- Ik had mgnl_uuid veld per ongeluk een maximale lengte gegeven. Dat later niet nodig gevonden, en weer verwijderd, maar hij blijft fouten geven over body.length.max. Caching? Defaults?
- LInk https://docs.prepr.io/reference/rest/v1/fetching-working-with-fields naar graphql is broken
- Queries lijkt niet per se goed te werken. Je kunt queryen op slug: https://docs.prepr.io/reference/rest/v1/fetching-single-items, maar hoe ik dan op een andere veld zou moeten queryen, is mij niet duidelijk. slug vervangen door mgnl_uuid lijkt domweg te worden genegeerd (geen validatie op query parameters natuurlijk)
 -> zie 3voor12-updates.py voor hoe het wel gaat.


== Data-migratie

https://docs.prepr.io/developing-with-prepr/migrate-content

https://docs.prepr.io/reference/rest/v1/content-items-create-update-and-destroy

=== python

[source, bash]
----
mihxil@baleno:~$ python3 -m venv ~/venvs/vpro-migrate
mihxil@baleno:~$ source ~/venvs/vpro-migrate/bin/activate

pip3 install elasticsearch python-dotenv requests
----

Tunnel ES:
[source, bash]
----
ssh -L9210:localhost:9200 os2-api-prod-01
----


